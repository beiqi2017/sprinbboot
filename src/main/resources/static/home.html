<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- Meta, title, CSS, favicons, etc. -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
<title>管理控制台</title>
<!-- Bootstrap -->
<link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
<!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
<script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
<!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="./tabs.js"></script>
 <script src="./plugin/bootbox.min.js"></script>
</head>
<style> 
html,body{height:100%}        
</style> 
<script>
	
	function change(e) {
		if ($(".col-md-3").is(":hidden")) {
			$(".col-md-12").attr("class", "col-md-9");
			$(e).attr("class", "glyphicon glyphicon-step-backward");
		} else {
			$(".col-md-9").attr("class", "col-md-12");
			$(e).attr("class", "glyphicon glyphicon-step-forward");
		}
		$(".col-md-3").toggle();
	}

	
	
	$(function() {

		function resize() {
			var contentHeight = $(document.body).outerHeight(true) - $(".navbar").outerHeight(true);
			$(".col-md-9,.col-md-3").css("height", contentHeight + "px");
			$(".col-md-9,.col-md-3") .css("max-height", contentHeight + "px");
			$("#home").css("height", contentHeight - $(".nav-tabs").outerHeight() + "px");
			$("#home").css("max-height", contentHeight - $(".nav-tabs").outerHeight() + "px");
		}
		
		 window.onresize=function(){
			// resize();
	     }
		 
		if(!navigator.userAgent.match(/mobile/i)) { 
			resize();
		}
		
		
		$.ajax({
	        type: "get",
	        url: "./user/menu",
	        dataType: "json",
	        success: function (result) {
	          $.each(result, function (index, obj) {
                 
	            var html='<div class="panel panel-default">'+
				 '<div class="panel-heading" role="tab" id="heading'+index+'">'+
					'<h4 class="panel-title" style="text-align:center">'+
						'<a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse'+index+'" aria-expanded="true" aria-controls="collapse'+index+'">'+ 
						 obj.menu +
						 '</a>'+
					'</h4>'+
				'</div>'+
				'<div id="collapse'+index+'" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="heading'+index+'">'+
					'<div class="panel-body" style="padding:0px;overflow-y: auto;max-height:200px;">'+
						'<ul class="nav nav-list" style="text-align:center">';
						 $.each(obj.modules, function (index1, obj1) {
							 html=html+'<li><a href="#" style="padding:5px 10px" onclick="addTab(\''+index+index1+'\',\''+obj1.url+'\',\''+obj1.menu+'\')">'+obj1.menu+'</a></li>';
						 })

						  html=html+'</ul></div></div></div>'
	        	          $("#accordion").append(html);
	        	
	        	 });
	        	
	        },
	        error: function () {
	        	console.log("树形结构加载失败！")
	        }
	    });
		
	})
	
	
	
	function password() {
		var login = new Object();
		login.password = $("#password").val().trim();
		login.password1 = $("#password1").val().trim();
		password2 = $("#password2").val().trim();
		if (!login.password || !login.password1 || !password2) {
			bootbox.alert("密码信息不能为空！");
			return;
		}
		if (login.password1 != password2) {
			bootbox.alert("新密码和确认密码不一致！");
			return;
		}

		$.ajax({
			type : "POST",
			url : "./upPassword",
			dataType : "json",
			contentType : "application/json",
			data : JSON.stringify(login),
			async : false,
			success : function(data) {
				if (data.success) {
					$('#myModal').modal('hide')
					bootbox.alert("修改成功")
				}else{
					bootbox.alert(data.msg)
				} 
			}
		});
	}
</script>
<body>

	<nav class="navbar navbar-inverse" style="margin-bottom: 0px;">
		<div class="container-fluid">
			<H4 class="navbar-text" style="font-family: 'Microsoft YaHei' ! important;font-weight:bold;">
			     营运管理系统
			</H4>
			<div class="collapse navbar-collapse"
				id="bs-example-navbar-collapse-1">
				<ul class="nav navbar-nav navbar-right">
					<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"> 
						<span class="glyphicon glyphicon-user"></span>
						  用户
                        <span class="caret"></span>
					</a>
						<ul class="dropdown-menu">
							<li><a href="#" data-toggle="modal" data-target="#myModal"><span class="glyphicon glyphicon-edit"></span>&nbsp;修改密码</a></li>
							<li role="separator" class="divider"></li>
							<li><a href="./logOut"><span class="glyphicon glyphicon-log-out"></span>&nbsp;退出</a></li>
						</ul></li>
				</ul>
			</div>
		</div>
	</nav>

	<div class="ontainer-fluid">
		<div class="row" style="margin:0px;">
			<div class="col-md-3" style="padding:1px;border-right: 1px solid #ddd;overflow: auto;background-color:WhiteSmoke;">

				<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
					
				</div>

			</div>

			<div  class="col-md-9" style="padding: 0px;">

				<div>
					<!-- Nav tabs -->
					<ul class="nav nav-tabs" role="tablist" id="tablist">
						<li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">
						<span class="glyphicon glyphicon-step-backward" id="show" onclick="change(this)"></span>&nbsp;首页
						</a></li>
					</ul>

					<!-- Tab panes -->
					<div class="tab-content" style="padding: 0px;" id="tab-content">
						<div role="tabpanel" class="tab-pane active" id="home" style="padding: 0px;overflow: auto;">

							aa<br> aa<br> aa<br> aa<br> aa<br> aa<br>
							aa<br> aa<br> aa<br> aa<br> aa<br> aa<br>
							aa<br> aa<br> aa<br> aa<br> aa<br> aa<br>
							aa<br> aa<br> aa<br> aa<br> aa<br> aa<br>
							aa<br> aa<br> aa<br> aa<br> aa<br> aa<br>
							aa<br> aa<br> aa<br> aa<br> aa<br> aa<br>

						</div>
					</div>
				</div>

			</div>
		</div>
		<div>
</body>



<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">修改密码</h4>
      </div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="form-group">
						<label class="col-sm-2 control-label">原密码</label>
						<div class="col-sm-10">
							<input type="password" class="form-control" id="password" placeholder="原密码">
						</div>
					</div>
					<div class="form-group">
						<label for="inputPassword" class="col-sm-2 control-label">新密码</label>
						<div class="col-sm-10">
							<input type="password" class="form-control" id="password1" placeholder="新密码">
						</div>
					</div>
					<div class="form-group">
						<label for="inputPassword" class="col-sm-2 control-label">确认密码</label>
						<div class="col-sm-10">
							<input type="password" class="form-control" id="password2" placeholder="确认密码">
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" onclick="password()">提交</button>
      </div>
    </div>
  </div>
</div>
</html>